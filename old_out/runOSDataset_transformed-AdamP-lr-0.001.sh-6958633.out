transferring data
Sun Jul  4 20:18:03 PDT 2021

Finished transferring
Sun Jul  4 20:18:06 PDT 2021

Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.001-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958633.0        
    output              : ADP_post_trained/OSDataset_transformed/AdamP/output/fine_tuning
    checkpoint          : ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/fine_tuning/lr-0.001
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 1                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Output dir ADP_post_trained/OSDataset_transformed/AdamP/output/fine_tuning does not exist, building
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              OSDataset_transformed
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              0.001               
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
AdamP on OSDataset_transformed: T 1/3 | E 1/200 Ended | E Time: 55.296s | ~Time Left: 11004.003s |  Train Loss: 0.8625 | Train Acc. 67.9897% | Test Loss: 0.8036 | Test Acc. 68.4815%
AdamP on OSDataset_transformed: T 1/3 | E 2/200 Ended | E Time: 54.535s | ~Time Left: 10797.949s |  Train Loss: 0.7220 | Train Acc. 73.1610% | Test Loss: 0.6888 | Test Acc. 74.1682%
AdamP on OSDataset_transformed: T 1/3 | E 3/200 Ended | E Time: 54.567s | ~Time Left: 10749.733s |  Train Loss: 0.6895 | Train Acc. 74.1892% | Test Loss: 0.9778 | Test Acc. 65.4567%
AdamP on OSDataset_transformed: T 1/3 | E 4/200 Ended | E Time: 54.710s | ~Time Left: 10723.241s |  Train Loss: 0.6462 | Train Acc. 76.3514% | Test Loss: 0.8111 | Test Acc. 71.3854%
AdamP on OSDataset_transformed: T 1/3 | E 5/200 Ended | E Time: 54.702s | ~Time Left: 10666.856s |  Train Loss: 0.6289 | Train Acc. 77.1301% | Test Loss: 0.6657 | Test Acc. 75.6201%
AdamP on OSDataset_transformed: T 1/3 | E 6/200 Ended | E Time: 54.557s | ~Time Left: 10584.011s |  Train Loss: 0.6014 | Train Acc. 78.1130% | Test Loss: 0.6987 | Test Acc. 75.8016%
AdamP on OSDataset_transformed: T 1/3 | E 7/200 Ended | E Time: 54.754s | ~Time Left: 10567.596s |  Train Loss: 0.6048 | Train Acc. 77.8559% | Test Loss: 0.6520 | Test Acc. 75.8016%
AdamP on OSDataset_transformed: T 1/3 | E 8/200 Ended | E Time: 54.578s | ~Time Left: 10479.049s |  Train Loss: 0.5740 | Train Acc. 79.2621% | Test Loss: 0.6720 | Test Acc. 76.7090%
AdamP on OSDataset_transformed: T 1/3 | E 9/200 Ended | E Time: 54.909s | ~Time Left: 10487.534s |  Train Loss: 0.5590 | Train Acc. 80.1542% | Test Loss: 0.6054 | Test Acc. 77.5560%
AdamP on OSDataset_transformed: T 1/3 | E 10/200 Ended | E Time: 54.732s | ~Time Left: 10399.134s |  Train Loss: 0.5466 | Train Acc. 80.5852% | Test Loss: 0.5322 | Test Acc. 81.3067%
AdamP on OSDataset_transformed: T 1/3 | E 11/200 Ended | E Time: 54.746s | ~Time Left: 10347.029s |  Train Loss: 0.5452 | Train Acc. 80.6456% | Test Loss: 0.5352 | Test Acc. 81.0647%
AdamP on OSDataset_transformed: T 1/3 | E 12/200 Ended | E Time: 54.777s | ~Time Left: 10298.089s |  Train Loss: 0.5349 | Train Acc. 80.7288% | Test Loss: 0.5492 | Test Acc. 80.2783%
AdamP on OSDataset_transformed: T 1/3 | E 13/200 Ended | E Time: 54.809s | ~Time Left: 10249.221s |  Train Loss: 0.5273 | Train Acc. 80.9027% | Test Loss: 0.5833 | Test Acc. 78.6449%
AdamP on OSDataset_transformed: T 1/3 | E 14/200 Ended | E Time: 54.575s | ~Time Left: 10150.892s |  Train Loss: 0.5102 | Train Acc. 81.5000% | Test Loss: 0.5157 | Test Acc. 82.2142%
AdamP on OSDataset_transformed: T 1/3 | E 15/200 Ended | E Time: 54.701s | ~Time Left: 10119.606s |  Train Loss: 0.5085 | Train Acc. 81.8780% | Test Loss: 0.5115 | Test Acc. 80.6413%
AdamP on OSDataset_transformed: T 1/3 | E 16/200 Ended | E Time: 54.502s | ~Time Left: 10028.421s |  Train Loss: 0.4938 | Train Acc. 82.3165% | Test Loss: 0.5649 | Test Acc. 78.2819%
AdamP on OSDataset_transformed: T 1/3 | E 17/200 Ended | E Time: 54.770s | ~Time Left: 10022.841s |  Train Loss: 0.4936 | Train Acc. 82.3089% | Test Loss: 0.5126 | Test Acc. 81.3067%
AdamP on OSDataset_transformed: T 1/3 | E 18/200 Ended | E Time: 54.796s | ~Time Left: 9972.786s |  Train Loss: 0.4943 | Train Acc. 82.5130% | Test Loss: 0.5162 | Test Acc. 82.2142%
AdamP on OSDataset_transformed: T 1/3 | E 19/200 Ended | E Time: 54.834s | ~Time Left: 9924.945s |  Train Loss: 0.4879 | Train Acc. 82.6340% | Test Loss: 0.5059 | Test Acc. 82.4561%
AdamP on OSDataset_transformed: T 1/3 | E 20/200 Ended | E Time: 54.766s | ~Time Left: 9857.907s |  Train Loss: 0.4786 | Train Acc. 82.8911% | Test Loss: 0.4815 | Test Acc. 82.7586%
AdamP on OSDataset_transformed: T 1/3 | E 21/200 Ended | E Time: 54.679s | ~Time Left: 9787.532s |  Train Loss: 0.4733 | Train Acc. 82.8155% | Test Loss: 0.4517 | Test Acc. 82.4561%
AdamP on OSDataset_transformed: T 1/3 | E 22/200 Ended | E Time: 54.666s | ~Time Left: 9730.524s |  Train Loss: 0.4734 | Train Acc. 82.8079% | Test Loss: 0.4602 | Test Acc. 83.0611%
AdamP on OSDataset_transformed: T 1/3 | E 23/200 Ended | E Time: 54.489s | ~Time Left: 9644.555s |  Train Loss: 0.4649 | Train Acc. 83.4808% | Test Loss: 0.4976 | Test Acc. 81.5487%
AdamP on OSDataset_transformed: T 1/3 | E 24/200 Ended | E Time: 54.520s | ~Time Left: 9595.583s |  Train Loss: 0.4601 | Train Acc. 83.6017% | Test Loss: 0.5250 | Test Acc. 81.1857%
AdamP on OSDataset_transformed: T 1/3 | E 25/200 Ended | E Time: 54.564s | ~Time Left: 9548.743s |  Train Loss: 0.4522 | Train Acc. 83.7302% | Test Loss: 0.8608 | Test Acc. 68.6025%
AdamP on OSDataset_transformed: T 1/3 | E 26/200 Ended | E Time: 54.654s | ~Time Left: 9509.837s |  Train Loss: 0.4571 | Train Acc. 83.5110% | Test Loss: 0.5466 | Test Acc. 79.9758%
AdamP on OSDataset_transformed: T 1/3 | E 27/200 Ended | E Time: 54.540s | ~Time Left: 9435.476s |  Train Loss: 0.4503 | Train Acc. 84.0931% | Test Loss: 0.4558 | Test Acc. 83.2426%
AdamP on OSDataset_transformed: T 1/3 | E 28/200 Ended | E Time: 54.678s | ~Time Left: 9404.674s |  Train Loss: 0.4524 | Train Acc. 84.0629% | Test Loss: 0.5350 | Test Acc. 80.3388%
AdamP on OSDataset_transformed: T 1/3 | E 29/200 Ended | E Time: 54.607s | ~Time Left: 9337.742s |  Train Loss: 0.4445 | Train Acc. 83.7378% | Test Loss: 0.4218 | Test Acc. 84.9970%
AdamP on OSDataset_transformed: T 1/3 | E 30/200 Ended | E Time: 54.750s | ~Time Left: 9307.462s |  Train Loss: 0.4441 | Train Acc. 84.1687% | Test Loss: 0.5270 | Test Acc. 80.7018%
AdamP on OSDataset_transformed: T 1/3 | E 31/200 Ended | E Time: 54.671s | ~Time Left: 9239.407s |  Train Loss: 0.4315 | Train Acc. 84.5770% | Test Loss: 0.5425 | Test Acc. 81.6092%
AdamP on OSDataset_transformed: T 1/3 | E 32/200 Ended | E Time: 54.857s | ~Time Left: 9215.914s |  Train Loss: 0.4418 | Train Acc. 83.9268% | Test Loss: 0.4535 | Test Acc. 84.2710%
AdamP on OSDataset_transformed: T 1/3 | E 33/200 Ended | E Time: 54.802s | ~Time Left: 9151.973s |  Train Loss: 0.4329 | Train Acc. 84.2670% | Test Loss: 0.4368 | Test Acc. 83.9080%
AdamP on OSDataset_transformed: T 1/3 | E 34/200 Ended | E Time: 54.662s | ~Time Left: 9073.963s |  Train Loss: 0.4350 | Train Acc. 84.6450% | Test Loss: 0.4273 | Test Acc. 84.5735%
AdamP on OSDataset_transformed: T 1/3 | E 35/200 Ended | E Time: 54.771s | ~Time Left: 9037.200s |  Train Loss: 0.4263 | Train Acc. 84.6828% | Test Loss: 0.4671 | Test Acc. 83.6661%
AdamP on OSDataset_transformed: T 1/3 | E 36/200 Ended | E Time: 54.887s | ~Time Left: 9001.523s |  Train Loss: 0.4255 | Train Acc. 84.7433% | Test Loss: 0.5387 | Test Acc. 78.8869%
AdamP on OSDataset_transformed: T 1/3 | E 37/200 Ended | E Time: 54.742s | ~Time Left: 8922.944s |  Train Loss: 0.4237 | Train Acc. 84.5014% | Test Loss: 0.4405 | Test Acc. 84.0895%
AdamP on OSDataset_transformed: T 1/3 | E 38/200 Ended | E Time: 54.728s | ~Time Left: 8865.862s |  Train Loss: 0.4287 | Train Acc. 84.7358% | Test Loss: 0.4257 | Test Acc. 84.7550%
AdamP on OSDataset_transformed: T 1/3 | E 39/200 Ended | E Time: 54.595s | ~Time Left: 8789.751s |  Train Loss: 0.4221 | Train Acc. 84.8492% | Test Loss: 0.5221 | Test Acc. 81.5487%
AdamP on OSDataset_transformed: T 1/3 | E 40/200 Ended | E Time: 54.645s | ~Time Left: 8743.242s |  Train Loss: 0.4191 | Train Acc. 84.9928% | Test Loss: 0.4470 | Test Acc. 83.4241%
AdamP on OSDataset_transformed: T 1/3 | E 41/200 Ended | E Time: 54.688s | ~Time Left: 8695.438s |  Train Loss: 0.4176 | Train Acc. 85.0306% | Test Loss: 0.4489 | Test Acc. 85.1180%
AdamP on OSDataset_transformed: T 1/3 | E 42/200 Ended | E Time: 54.626s | ~Time Left: 8630.932s |  Train Loss: 0.4124 | Train Acc. 85.3028% | Test Loss: 0.4710 | Test Acc. 82.9401%
AdamP on OSDataset_transformed: T 1/3 | E 43/200 Ended | E Time: 54.930s | ~Time Left: 8624.025s |  Train Loss: 0.4161 | Train Acc. 84.8114% | Test Loss: 0.4569 | Test Acc. 83.9080%
AdamP on OSDataset_transformed: T 1/3 | E 44/200 Ended | E Time: 54.687s | ~Time Left: 8531.222s |  Train Loss: 0.4039 | Train Acc. 85.3103% | Test Loss: 0.4438 | Test Acc. 84.4525%
AdamP on OSDataset_transformed: T 1/3 | E 45/200 Ended | E Time: 55.075s | ~Time Left: 8536.650s |  Train Loss: 0.4081 | Train Acc. 85.2877% | Test Loss: 0.4386 | Test Acc. 84.6340%
AdamP on OSDataset_transformed: T 1/3 | E 46/200 Ended | E Time: 54.895s | ~Time Left: 8453.898s |  Train Loss: 0.4006 | Train Acc. 85.3255% | Test Loss: 0.4750 | Test Acc. 83.2426%
AdamP on OSDataset_transformed: T 1/3 | E 47/200 Ended | E Time: 54.648s | ~Time Left: 8361.077s |  Train Loss: 0.4102 | Train Acc. 85.0760% | Test Loss: 0.4603 | Test Acc. 82.5771%
AdamP on OSDataset_transformed: T 1/3 | E 48/200 Ended | E Time: 54.611s | ~Time Left: 8300.927s |  Train Loss: 0.4028 | Train Acc. 85.6052% | Test Loss: 0.4214 | Test Acc. 84.8155%
AdamP on OSDataset_transformed: T 1/3 | E 49/200 Ended | E Time: 54.755s | ~Time Left: 8267.965s |  Train Loss: 0.4084 | Train Acc. 85.1818% | Test Loss: 0.4075 | Test Acc. 85.3599%
AdamP on OSDataset_transformed: T 1/3 | E 50/200 Ended | E Time: 54.779s | ~Time Left: 8216.791s |  Train Loss: 0.4015 | Train Acc. 85.6354% | Test Loss: 0.4586 | Test Acc. 83.1821%
AdamP on OSDataset_transformed: T 1/3 | E 51/200 Ended | E Time: 54.565s | ~Time Left: 8130.209s |  Train Loss: 0.3988 | Train Acc. 85.6052% | Test Loss: 0.4393 | Test Acc. 84.1500%
AdamP on OSDataset_transformed: T 1/3 | E 52/200 Ended | E Time: 55.000s | ~Time Left: 8140.054s |  Train Loss: 0.4003 | Train Acc. 85.5901% | Test Loss: 0.5169 | Test Acc. 82.5771%
AdamP on OSDataset_transformed: T 1/3 | E 53/200 Ended | E Time: 54.723s | ~Time Left: 8044.276s |  Train Loss: 0.3915 | Train Acc. 86.0286% | Test Loss: 0.4539 | Test Acc. 83.9685%
AdamP on OSDataset_transformed: T 1/3 | E 54/200 Ended | E Time: 54.779s | ~Time Left: 7997.677s |  Train Loss: 0.3942 | Train Acc. 85.7337% | Test Loss: 0.4917 | Test Acc. 80.8832%
AdamP on OSDataset_transformed: T 1/3 | E 55/200 Ended | E Time: 54.914s | ~Time Left: 7962.506s |  Train Loss: 0.3888 | Train Acc. 86.0135% | Test Loss: 0.4656 | Test Acc. 83.4241%
AdamP on OSDataset_transformed: T 1/3 | E 56/200 Ended | E Time: 54.831s | ~Time Left: 7895.669s |  Train Loss: 0.3859 | Train Acc. 86.1949% | Test Loss: 0.4102 | Test Acc. 86.0859%
Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.001-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958633.0        
    output              : ADP_post_trained/OSDataset_transformed/AdamP/output/deep_tuning
    checkpoint          : ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/deep_tuning/lr-0.001
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 0                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              OSDataset_transformed
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              0.001               
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
