transferring data
Sun Jul  4 20:17:59 PDT 2021

Finished transferring
Sun Jul  4 20:18:06 PDT 2021

Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.0005-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958634.0        
    output              : ADP_post_trained/OSDataset_transformed/AdamP/output/fine_tuning
    checkpoint          : ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/fine_tuning/lr-0.0005
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 1                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              OSDataset_transformed
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              0.0005              
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
AdamP on OSDataset_transformed: T 1/3 | E 1/200 Ended | E Time: 55.517s | ~Time Left: 11047.848s |  Train Loss: 0.8106 | Train Acc. 70.0990% | Test Loss: 1.0409 | Test Acc. 62.0690%
AdamP on OSDataset_transformed: T 1/3 | E 2/200 Ended | E Time: 54.363s | ~Time Left: 10763.929s |  Train Loss: 0.6883 | Train Acc. 74.4311% | Test Loss: 0.6477 | Test Acc. 75.2571%
AdamP on OSDataset_transformed: T 1/3 | E 3/200 Ended | E Time: 54.292s | ~Time Left: 10695.513s |  Train Loss: 0.6484 | Train Acc. 76.4724% | Test Loss: 0.6906 | Test Acc. 76.1040%
AdamP on OSDataset_transformed: T 1/3 | E 4/200 Ended | E Time: 54.273s | ~Time Left: 10637.461s |  Train Loss: 0.5957 | Train Acc. 78.5514% | Test Loss: 0.6120 | Test Acc. 77.4955%
AdamP on OSDataset_transformed: T 1/3 | E 5/200 Ended | E Time: 54.331s | ~Time Left: 10594.629s |  Train Loss: 0.5756 | Train Acc. 79.2621% | Test Loss: 0.6349 | Test Acc. 77.8584%
AdamP on OSDataset_transformed: T 1/3 | E 6/200 Ended | E Time: 54.212s | ~Time Left: 10517.165s |  Train Loss: 0.5577 | Train Acc. 79.7611% | Test Loss: 0.5417 | Test Acc. 80.3388%
AdamP on OSDataset_transformed: T 1/3 | E 7/200 Ended | E Time: 54.177s | ~Time Left: 10456.213s |  Train Loss: 0.5395 | Train Acc. 80.2979% | Test Loss: 0.5200 | Test Acc. 81.2462%
AdamP on OSDataset_transformed: T 1/3 | E 8/200 Ended | E Time: 54.205s | ~Time Left: 10407.293s |  Train Loss: 0.5281 | Train Acc. 81.2051% | Test Loss: 0.5436 | Test Acc. 80.0968%
AdamP on OSDataset_transformed: T 1/3 | E 9/200 Ended | E Time: 54.450s | ~Time Left: 10400.015s |  Train Loss: 0.5165 | Train Acc. 81.6058% | Test Loss: 0.5549 | Test Acc. 79.3708%
AdamP on OSDataset_transformed: T 1/3 | E 10/200 Ended | E Time: 54.280s | ~Time Left: 10313.197s |  Train Loss: 0.5039 | Train Acc. 81.9838% | Test Loss: 0.5202 | Test Acc. 80.6413%
AdamP on OSDataset_transformed: T 1/3 | E 11/200 Ended | E Time: 54.192s | ~Time Left: 10242.269s |  Train Loss: 0.4917 | Train Acc. 82.2938% | Test Loss: 0.5404 | Test Acc. 80.2178%
AdamP on OSDataset_transformed: T 1/3 | E 12/200 Ended | E Time: 54.297s | ~Time Left: 10207.915s |  Train Loss: 0.4873 | Train Acc. 82.6416% | Test Loss: 0.5093 | Test Acc. 82.5771%
AdamP on OSDataset_transformed: T 1/3 | E 13/200 Ended | E Time: 54.210s | ~Time Left: 10137.215s |  Train Loss: 0.4769 | Train Acc. 83.1254% | Test Loss: 0.4775 | Test Acc. 83.3636%
AdamP on OSDataset_transformed: T 1/3 | E 14/200 Ended | E Time: 54.433s | ~Time Left: 10124.564s |  Train Loss: 0.4727 | Train Acc. 83.1027% | Test Loss: 0.4641 | Test Acc. 83.7266%
AdamP on OSDataset_transformed: T 1/3 | E 15/200 Ended | E Time: 54.256s | ~Time Left: 10037.392s |  Train Loss: 0.4627 | Train Acc. 83.3976% | Test Loss: 0.4456 | Test Acc. 84.3920%
AdamP on OSDataset_transformed: T 1/3 | E 16/200 Ended | E Time: 54.232s | ~Time Left: 9978.723s |  Train Loss: 0.4627 | Train Acc. 83.4354% | Test Loss: 0.4750 | Test Acc. 82.9401%
AdamP on OSDataset_transformed: T 1/3 | E 17/200 Ended | E Time: 54.426s | ~Time Left: 9959.931s |  Train Loss: 0.4517 | Train Acc. 83.9722% | Test Loss: 0.5148 | Test Acc. 81.6092%
AdamP on OSDataset_transformed: T 1/3 | E 18/200 Ended | E Time: 54.185s | ~Time Left: 9861.610s |  Train Loss: 0.4484 | Train Acc. 84.0931% | Test Loss: 0.4941 | Test Acc. 82.0327%
AdamP on OSDataset_transformed: T 1/3 | E 19/200 Ended | E Time: 54.323s | ~Time Left: 9832.485s |  Train Loss: 0.4481 | Train Acc. 83.7907% | Test Loss: 0.4371 | Test Acc. 84.1500%
AdamP on OSDataset_transformed: T 1/3 | E 20/200 Ended | E Time: 54.373s | ~Time Left: 9787.204s |  Train Loss: 0.4464 | Train Acc. 83.9949% | Test Loss: 0.4468 | Test Acc. 83.5451%
AdamP on OSDataset_transformed: T 1/3 | E 21/200 Ended | E Time: 54.491s | ~Time Left: 9753.899s |  Train Loss: 0.4430 | Train Acc. 83.8739% | Test Loss: 0.4848 | Test Acc. 82.9401%
AdamP on OSDataset_transformed: T 1/3 | E 22/200 Ended | E Time: 54.397s | ~Time Left: 9682.579s |  Train Loss: 0.4308 | Train Acc. 84.1763% | Test Loss: 0.4658 | Test Acc. 83.7266%
AdamP on OSDataset_transformed: T 1/3 | E 23/200 Ended | E Time: 54.226s | ~Time Left: 9597.940s |  Train Loss: 0.4311 | Train Acc. 84.4863% | Test Loss: 0.4648 | Test Acc. 84.0895%
AdamP on OSDataset_transformed: T 1/3 | E 24/200 Ended | E Time: 54.570s | ~Time Left: 9604.294s |  Train Loss: 0.4281 | Train Acc. 84.3426% | Test Loss: 0.4444 | Test Acc. 84.2105%
AdamP on OSDataset_transformed: T 1/3 | E 25/200 Ended | E Time: 54.710s | ~Time Left: 9574.223s |  Train Loss: 0.4238 | Train Acc. 84.7962% | Test Loss: 0.4456 | Test Acc. 84.9970%
AdamP on OSDataset_transformed: T 1/3 | E 26/200 Ended | E Time: 54.439s | ~Time Left: 9472.443s |  Train Loss: 0.4151 | Train Acc. 85.0760% | Test Loss: 0.5082 | Test Acc. 82.2747%
AdamP on OSDataset_transformed: T 1/3 | E 27/200 Ended | E Time: 54.434s | ~Time Left: 9417.018s |  Train Loss: 0.4181 | Train Acc. 84.9172% | Test Loss: 0.4506 | Test Acc. 84.5130%
AdamP on OSDataset_transformed: T 1/3 | E 28/200 Ended | E Time: 54.315s | ~Time Left: 9342.256s |  Train Loss: 0.4110 | Train Acc. 85.1365% | Test Loss: 0.4434 | Test Acc. 84.2105%
AdamP on OSDataset_transformed: T 1/3 | E 29/200 Ended | E Time: 54.454s | ~Time Left: 9311.551s |  Train Loss: 0.4033 | Train Acc. 85.1894% | Test Loss: 0.4346 | Test Acc. 84.9365%
AdamP on OSDataset_transformed: T 1/3 | E 30/200 Ended | E Time: 54.491s | ~Time Left: 9263.432s |  Train Loss: 0.4004 | Train Acc. 85.4767% | Test Loss: 0.4069 | Test Acc. 86.0254%
AdamP on OSDataset_transformed: T 1/3 | E 31/200 Ended | E Time: 54.412s | ~Time Left: 9195.687s |  Train Loss: 0.3997 | Train Acc. 85.5825% | Test Loss: 0.4213 | Test Acc. 85.4204%
AdamP on OSDataset_transformed: T 1/3 | E 32/200 Ended | E Time: 54.369s | ~Time Left: 9134.050s |  Train Loss: 0.4050 | Train Acc. 85.4616% | Test Loss: 0.4153 | Test Acc. 85.6624%
AdamP on OSDataset_transformed: T 1/3 | E 33/200 Ended | E Time: 54.440s | ~Time Left: 9091.561s |  Train Loss: 0.3942 | Train Acc. 85.4616% | Test Loss: 0.4495 | Test Acc. 84.0290%
AdamP on OSDataset_transformed: T 1/3 | E 34/200 Ended | E Time: 54.532s | ~Time Left: 9052.251s |  Train Loss: 0.3966 | Train Acc. 85.7488% | Test Loss: 0.4105 | Test Acc. 85.3599%
AdamP on OSDataset_transformed: T 1/3 | E 35/200 Ended | E Time: 54.446s | ~Time Left: 8983.546s |  Train Loss: 0.3897 | Train Acc. 85.9076% | Test Loss: 0.4967 | Test Acc. 82.0327%
AdamP on OSDataset_transformed: T 1/3 | E 36/200 Ended | E Time: 54.540s | ~Time Left: 8944.602s |  Train Loss: 0.3908 | Train Acc. 85.6657% | Test Loss: 0.4124 | Test Acc. 85.7834%
AdamP on OSDataset_transformed: T 1/3 | E 37/200 Ended | E Time: 54.279s | ~Time Left: 8847.473s |  Train Loss: 0.3861 | Train Acc. 86.1495% | Test Loss: 0.3935 | Test Acc. 85.7229%
AdamP on OSDataset_transformed: T 1/3 | E 38/200 Ended | E Time: 54.435s | ~Time Left: 8818.413s |  Train Loss: 0.3802 | Train Acc. 85.8244% | Test Loss: 0.4905 | Test Acc. 83.0611%
AdamP on OSDataset_transformed: T 1/3 | E 39/200 Ended | E Time: 54.316s | ~Time Left: 8744.893s |  Train Loss: 0.3880 | Train Acc. 86.0437% | Test Loss: 0.4055 | Test Acc. 85.7229%
AdamP on OSDataset_transformed: T 1/3 | E 40/200 Ended | E Time: 54.485s | ~Time Left: 8717.607s |  Train Loss: 0.3760 | Train Acc. 86.1571% | Test Loss: 0.3937 | Test Acc. 86.3884%
AdamP on OSDataset_transformed: T 1/3 | E 41/200 Ended | E Time: 54.331s | ~Time Left: 8638.660s |  Train Loss: 0.3784 | Train Acc. 86.1117% | Test Loss: 0.4068 | Test Acc. 86.0254%
AdamP on OSDataset_transformed: T 1/3 | E 42/200 Ended | E Time: 54.464s | ~Time Left: 8605.258s |  Train Loss: 0.3695 | Train Acc. 86.7241% | Test Loss: 0.4319 | Test Acc. 85.2390%
AdamP on OSDataset_transformed: T 1/3 | E 43/200 Ended | E Time: 54.311s | ~Time Left: 8526.797s |  Train Loss: 0.3722 | Train Acc. 86.4973% | Test Loss: 0.3932 | Test Acc. 86.3884%
AdamP on OSDataset_transformed: T 1/3 | E 44/200 Ended | E Time: 54.412s | ~Time Left: 8488.325s |  Train Loss: 0.3692 | Train Acc. 86.7166% | Test Loss: 0.4314 | Test Acc. 84.9970%
AdamP on OSDataset_transformed: T 1/3 | E 45/200 Ended | E Time: 54.245s | ~Time Left: 8407.959s |  Train Loss: 0.3712 | Train Acc. 86.4671% | Test Loss: 0.4229 | Test Acc. 85.2995%
AdamP on OSDataset_transformed: T 1/3 | E 46/200 Ended | E Time: 54.385s | ~Time Left: 8375.277s |  Train Loss: 0.3604 | Train Acc. 86.8451% | Test Loss: 0.3923 | Test Acc. 86.2069%
AdamP on OSDataset_transformed: T 1/3 | E 47/200 Ended | E Time: 54.319s | ~Time Left: 8310.767s |  Train Loss: 0.3677 | Train Acc. 86.8678% | Test Loss: 0.5890 | Test Acc. 80.3388%
AdamP on OSDataset_transformed: T 1/3 | E 48/200 Ended | E Time: 54.248s | ~Time Left: 8245.712s |  Train Loss: 0.3670 | Train Acc. 86.7544% | Test Loss: 0.4208 | Test Acc. 84.0290%
AdamP on OSDataset_transformed: T 1/3 | E 49/200 Ended | E Time: 54.495s | ~Time Left: 8228.787s |  Train Loss: 0.3673 | Train Acc. 86.9434% | Test Loss: 0.3786 | Test Acc. 87.1748%
AdamP on OSDataset_transformed: T 1/3 | E 50/200 Ended | E Time: 54.300s | ~Time Left: 8144.952s |  Train Loss: 0.3603 | Train Acc. 86.8753% | Test Loss: 0.4123 | Test Acc. 84.6945%
AdamP on OSDataset_transformed: T 1/3 | E 51/200 Ended | E Time: 54.262s | ~Time Left: 8084.966s |  Train Loss: 0.3560 | Train Acc. 86.9509% | Test Loss: 0.3887 | Test Acc. 86.1464%
AdamP on OSDataset_transformed: T 1/3 | E 52/200 Ended | E Time: 54.232s | ~Time Left: 8026.401s |  Train Loss: 0.3504 | Train Acc. 87.1173% | Test Loss: 0.4187 | Test Acc. 84.8760%
AdamP on OSDataset_transformed: T 1/3 | E 53/200 Ended | E Time: 54.400s | ~Time Left: 7996.801s |  Train Loss: 0.3552 | Train Acc. 86.9131% | Test Loss: 0.4091 | Test Acc. 85.1180%
AdamP on OSDataset_transformed: T 1/3 | E 54/200 Ended | E Time: 54.118s | ~Time Left: 7901.265s |  Train Loss: 0.3445 | Train Acc. 87.5936% | Test Loss: 0.4172 | Test Acc. 86.2069%
AdamP on OSDataset_transformed: T 1/3 | E 55/200 Ended | E Time: 54.228s | ~Time Left: 7863.121s |  Train Loss: 0.3483 | Train Acc. 87.2080% | Test Loss: 0.4130 | Test Acc. 84.8760%
AdamP on OSDataset_transformed: T 1/3 | E 56/200 Ended | E Time: 54.352s | ~Time Left: 7826.640s |  Train Loss: 0.3481 | Train Acc. 87.1551% | Test Loss: 0.3811 | Test Acc. 86.5094%
AdamP on OSDataset_transformed: T 1/3 | E 57/200 Ended | E Time: 54.276s | ~Time Left: 7761.449s |  Train Loss: 0.3489 | Train Acc. 87.2533% | Test Loss: 0.3731 | Test Acc. 86.7514%
AdamP on OSDataset_transformed: T 1/3 | E 58/200 Ended | E Time: 54.523s | ~Time Left: 7742.218s |  Train Loss: 0.3447 | Train Acc. 87.7221% | Test Loss: 0.4393 | Test Acc. 83.8475%
AdamP on OSDataset_transformed: T 1/3 | E 59/200 Ended | E Time: 54.360s | ~Time Left: 7664.814s |  Train Loss: 0.3501 | Train Acc. 87.1475% | Test Loss: 0.3833 | Test Acc. 86.7514%
AdamP on OSDataset_transformed: T 1/3 | E 60/200 Ended | E Time: 54.328s | ~Time Left: 7605.962s |  Train Loss: 0.3427 | Train Acc. 87.5709% | Test Loss: 0.3995 | Test Acc. 85.3599%
AdamP on OSDataset_transformed: T 1/3 | E 61/200 Ended | E Time: 54.376s | ~Time Left: 7558.332s |  Train Loss: 0.3409 | Train Acc. 87.2458% | Test Loss: 0.4125 | Test Acc. 85.3599%
AdamP on OSDataset_transformed: T 1/3 | E 62/200 Ended | E Time: 53.932s | ~Time Left: 7442.571s |  Train Loss: 0.3455 | Train Acc. 87.5104% | Test Loss: 0.6106 | Test Acc. 80.3388%
AdamP on OSDataset_transformed: T 1/3 | E 63/200 Ended | E Time: 53.760s | ~Time Left: 7365.092s |  Train Loss: 0.3433 | Train Acc. 87.4877% | Test Loss: 0.4634 | Test Acc. 82.2747%
AdamP on OSDataset_transformed: T 1/3 | E 64/200 Ended | E Time: 53.558s | ~Time Left: 7283.921s |  Train Loss: 0.3352 | Train Acc. 87.7070% | Test Loss: 0.3929 | Test Acc. 86.5699%
AdamP on OSDataset_transformed: T 1/3 | E 65/200 Ended | E Time: 53.554s | ~Time Left: 7229.731s |  Train Loss: 0.3379 | Train Acc. 87.6087% | Test Loss: 0.3941 | Test Acc. 86.3884%
AdamP on OSDataset_transformed: T 1/3 | E 66/200 Ended | E Time: 53.497s | ~Time Left: 7168.642s |  Train Loss: 0.3319 | Train Acc. 88.0321% | Test Loss: 0.4869 | Test Acc. 82.5771%
AdamP on OSDataset_transformed: T 1/3 | E 67/200 Ended | E Time: 53.431s | ~Time Left: 7106.296s |  Train Loss: 0.3365 | Train Acc. 87.6767% | Test Loss: 0.3580 | Test Acc. 87.4168%
Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 491, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/adas/train.py", line 871, in <module>
    main(args)
  File "src/adas/train.py", line 834, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "src/adas/train.py", line 863, in main_worker
    training_agent.train()
  File "src/adas/train.py", line 411, in train
    self.run_epochs(trial, epochs)
  File "src/adas/train.py", line 466, in run_epochs
    torch.save(
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 106285120 vs 106285008
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 106285120 vs 106285008
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x2b165744f0e7 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x206a420 (0x2b16075e3420 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x20665f3 (0x2b16075df5f3 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x2b16075e3d99 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x2b16075e48d1 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x2b16075e50c5 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x737903 (0x2b16044b0903 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x369b90 (0x2b16040e2b90 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x36adfe (0x2b16040e3dfe in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #22: __libc_start_main + 0xeb (0x2b16019c8e1b in /cvmfs/soft.computecanada.ca/gentoo/2020/lib64/libc.so.6)

/var/spool/slurmd/job6958634/slurm_script: line 30: 146551 Aborted                 (core dumped) python src/adas/train.py --config PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.0005-config-AdamP.yaml --output ADP_post_trained/OSDataset_transformed/AdamP/output/fine_tuning --checkpoint ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/fine_tuning/lr-0.0005 --data $SLURM_TMPDIR --pretrained_model /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar --freeze_encoder True
Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.0005-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958634.0        
    output              : ADP_post_trained/OSDataset_transformed/AdamP/output/deep_tuning
    checkpoint          : ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/deep_tuning/lr-0.0005
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 0                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              OSDataset_transformed
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              0.0005              
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
AdamP on OSDataset_transformed: T 1/3 | E 1/200 Ended | E Time: 54.862s | ~Time Left: 10917.575s |  Train Loss: 0.8275 | Train Acc. 69.2901% | Test Loss: 0.7639 | Test Acc. 71.1434%
Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 491, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 5265536 vs 5265424

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/adas/train.py", line 871, in <module>
    main(args)
  File "src/adas/train.py", line 834, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "src/adas/train.py", line 863, in main_worker
    training_agent.train()
  File "src/adas/train.py", line 411, in train
    self.run_epochs(trial, epochs)
  File "src/adas/train.py", line 462, in run_epochs
    torch.save(data, str(self.checkpoint_path / filename))
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 5265536 vs 5265424
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x2b1a5f6830e7 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x206a420 (0x2b1a0f817420 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x20665f3 (0x2b1a0f8135f3 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x2b1a0f817d99 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x2b1a0f8188d1 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x2b1a0f8190c5 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x737903 (0x2b1a0c6e4903 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x369b90 (0x2b1a0c316b90 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x36adfe (0x2b1a0c317dfe in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #22: __libc_start_main + 0xeb (0x2b1a09bfce1b in /cvmfs/soft.computecanada.ca/gentoo/2020/lib64/libc.so.6)

/var/spool/slurmd/job6958634/slurm_script: line 31: 159945 Aborted                 (core dumped) python src/adas/train.py --config PostTrainingConfigs/OSDataset_transformed_testing/AdamP/lr-0.0005-config-AdamP.yaml --output ADP_post_trained/OSDataset_transformed/AdamP/output/deep_tuning --checkpoint ADP_post_trained/OSDataset_transformed/AdamP/checkpoint/deep_tuning/lr-0.0005 --data $SLURM_TMPDIR --pretrained_model /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar --freeze_encoder False
