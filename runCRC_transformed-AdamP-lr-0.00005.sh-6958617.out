transferring data
Sun Jul  4 20:15:18 PDT 2021

Finished transferring
Sun Jul  4 20:15:22 PDT 2021

Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/CRC_transformed_testing/AdamP/lr-0.00005-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958617.0        
    output              : ADP_post_trained/CRC_transformed/AdamP/output/fine_tuning
    checkpoint          : ADP_post_trained/CRC_transformed/AdamP/checkpoint/fine_tuning/lr-0.00005
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 1                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Output dir ADP_post_trained/CRC_transformed/AdamP/output/fine_tuning does not exist, building
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              CRC_transformed     
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              5e-05               
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
AdamP on CRC_transformed: T 1/3 | E 1/200 Ended | E Time: 60.054s | ~Time Left: 11950.762s |  Train Loss: 0.8824 | Train Acc. 66.0714% | Test Loss: 0.6193 | Test Acc. 77.8571%
AdamP on CRC_transformed: T 1/3 | E 2/200 Ended | E Time: 59.124s | ~Time Left: 11706.565s |  Train Loss: 0.6272 | Train Acc. 76.2357% | Test Loss: 0.4956 | Test Acc. 82.3571%
AdamP on CRC_transformed: T 1/3 | E 3/200 Ended | E Time: 58.804s | ~Time Left: 11584.423s |  Train Loss: 0.5149 | Train Acc. 81.0857% | Test Loss: 0.3921 | Test Acc. 86.0000%
AdamP on CRC_transformed: T 1/3 | E 4/200 Ended | E Time: 59.143s | ~Time Left: 11592.006s |  Train Loss: 0.4454 | Train Acc. 83.5429% | Test Loss: 0.6559 | Test Acc. 78.0714%
AdamP on CRC_transformed: T 1/3 | E 5/200 Ended | E Time: 58.855s | ~Time Left: 11476.635s |  Train Loss: 0.3809 | Train Acc. 86.4857% | Test Loss: 0.3045 | Test Acc. 89.4286%
AdamP on CRC_transformed: T 1/3 | E 6/200 Ended | E Time: 58.912s | ~Time Left: 11429.025s |  Train Loss: 0.3352 | Train Acc. 88.1429% | Test Loss: 0.2720 | Test Acc. 89.6429%
AdamP on CRC_transformed: T 1/3 | E 7/200 Ended | E Time: 59.005s | ~Time Left: 11388.019s |  Train Loss: 0.3147 | Train Acc. 89.0500% | Test Loss: 0.2918 | Test Acc. 89.5000%
AdamP on CRC_transformed: T 1/3 | E 8/200 Ended | E Time: 58.983s | ~Time Left: 11324.670s |  Train Loss: 0.2789 | Train Acc. 90.0143% | Test Loss: 0.2917 | Test Acc. 89.7143%
AdamP on CRC_transformed: T 1/3 | E 9/200 Ended | E Time: 59.198s | ~Time Left: 11306.811s |  Train Loss: 0.2809 | Train Acc. 89.7714% | Test Loss: 0.3510 | Test Acc. 86.8571%
AdamP on CRC_transformed: T 1/3 | E 10/200 Ended | E Time: 58.979s | ~Time Left: 11205.997s |  Train Loss: 0.2549 | Train Acc. 90.7000% | Test Loss: 0.2043 | Test Acc. 93.1429%
AdamP on CRC_transformed: T 1/3 | E 11/200 Ended | E Time: 59.210s | ~Time Left: 11190.646s |  Train Loss: 0.2534 | Train Acc. 91.0643% | Test Loss: 0.2022 | Test Acc. 93.4286%
AdamP on CRC_transformed: T 1/3 | E 12/200 Ended | E Time: 58.778s | ~Time Left: 11050.309s |  Train Loss: 0.2343 | Train Acc. 91.8643% | Test Loss: 0.1757 | Test Acc. 93.5000%
AdamP on CRC_transformed: T 1/3 | E 13/200 Ended | E Time: 58.881s | ~Time Left: 11010.782s |  Train Loss: 0.2240 | Train Acc. 92.0214% | Test Loss: 0.1971 | Test Acc. 92.5714%
AdamP on CRC_transformed: T 1/3 | E 14/200 Ended | E Time: 59.203s | ~Time Left: 11011.793s |  Train Loss: 0.2160 | Train Acc. 92.5429% | Test Loss: 0.1845 | Test Acc. 93.4286%
AdamP on CRC_transformed: T 1/3 | E 15/200 Ended | E Time: 59.144s | ~Time Left: 10941.625s |  Train Loss: 0.2148 | Train Acc. 92.4500% | Test Loss: 0.2135 | Test Acc. 91.7857%
AdamP on CRC_transformed: T 1/3 | E 16/200 Ended | E Time: 59.066s | ~Time Left: 10868.198s |  Train Loss: 0.2039 | Train Acc. 92.6357% | Test Loss: 0.1846 | Test Acc. 93.2857%
AdamP on CRC_transformed: T 1/3 | E 17/200 Ended | E Time: 59.178s | ~Time Left: 10829.621s |  Train Loss: 0.1984 | Train Acc. 93.1857% | Test Loss: 0.1835 | Test Acc. 93.1429%
AdamP on CRC_transformed: T 1/3 | E 18/200 Ended | E Time: 58.962s | ~Time Left: 10731.083s |  Train Loss: 0.1949 | Train Acc. 93.0000% | Test Loss: 0.2013 | Test Acc. 92.7143%
AdamP on CRC_transformed: T 1/3 | E 19/200 Ended | E Time: 58.641s | ~Time Left: 10613.949s |  Train Loss: 0.1842 | Train Acc. 93.5214% | Test Loss: 0.1754 | Test Acc. 94.1429%
AdamP on CRC_transformed: T 1/3 | E 20/200 Ended | E Time: 58.929s | ~Time Left: 10607.239s |  Train Loss: 0.1779 | Train Acc. 93.8571% | Test Loss: 0.1571 | Test Acc. 94.3571%
AdamP on CRC_transformed: T 1/3 | E 21/200 Ended | E Time: 59.041s | ~Time Left: 10568.355s |  Train Loss: 0.1669 | Train Acc. 94.1500% | Test Loss: 0.1841 | Test Acc. 94.0714%
AdamP on CRC_transformed: T 1/3 | E 22/200 Ended | E Time: 59.003s | ~Time Left: 10502.606s |  Train Loss: 0.1682 | Train Acc. 93.9786% | Test Loss: 0.1416 | Test Acc. 95.3571%
AdamP on CRC_transformed: T 1/3 | E 23/200 Ended | E Time: 58.986s | ~Time Left: 10440.590s |  Train Loss: 0.1612 | Train Acc. 94.5000% | Test Loss: 0.1230 | Test Acc. 96.0714%
AdamP on CRC_transformed: T 1/3 | E 24/200 Ended | E Time: 58.893s | ~Time Left: 10365.139s |  Train Loss: 0.1636 | Train Acc. 94.4286% | Test Loss: 0.1383 | Test Acc. 95.5714%
AdamP on CRC_transformed: T 1/3 | E 25/200 Ended | E Time: 58.944s | ~Time Left: 10315.183s |  Train Loss: 0.1518 | Train Acc. 94.8500% | Test Loss: 0.1224 | Test Acc. 95.6429%
AdamP on CRC_transformed: T 1/3 | E 26/200 Ended | E Time: 59.012s | ~Time Left: 10268.119s |  Train Loss: 0.1526 | Train Acc. 94.6857% | Test Loss: 0.1286 | Test Acc. 95.4286%
AdamP on CRC_transformed: T 1/3 | E 27/200 Ended | E Time: 59.288s | ~Time Left: 10256.807s |  Train Loss: 0.1508 | Train Acc. 94.8643% | Test Loss: 0.1533 | Test Acc. 94.4286%
AdamP on CRC_transformed: T 1/3 | E 28/200 Ended | E Time: 58.966s | ~Time Left: 10142.155s |  Train Loss: 0.1447 | Train Acc. 94.9929% | Test Loss: 0.1241 | Test Acc. 96.0000%
AdamP on CRC_transformed: T 1/3 | E 29/200 Ended | E Time: 58.832s | ~Time Left: 10060.266s |  Train Loss: 0.1458 | Train Acc. 94.7929% | Test Loss: 0.1392 | Test Acc. 95.1429%
AdamP on CRC_transformed: T 1/3 | E 30/200 Ended | E Time: 58.869s | ~Time Left: 10007.745s |  Train Loss: 0.1371 | Train Acc. 95.4214% | Test Loss: 0.1201 | Test Acc. 96.1429%
AdamP on CRC_transformed: T 1/3 | E 31/200 Ended | E Time: 59.066s | ~Time Left: 9982.171s |  Train Loss: 0.1398 | Train Acc. 95.1286% | Test Loss: 0.1097 | Test Acc. 96.5714%
AdamP on CRC_transformed: T 1/3 | E 32/200 Ended | E Time: 59.016s | ~Time Left: 9914.751s |  Train Loss: 0.1358 | Train Acc. 95.1643% | Test Loss: 0.1225 | Test Acc. 96.2143%
AdamP on CRC_transformed: T 1/3 | E 33/200 Ended | E Time: 59.107s | ~Time Left: 9870.835s |  Train Loss: 0.1249 | Train Acc. 95.4929% | Test Loss: 0.1418 | Test Acc. 95.1429%
AdamP on CRC_transformed: T 1/3 | E 34/200 Ended | E Time: 59.338s | ~Time Left: 9850.084s |  Train Loss: 0.1229 | Train Acc. 95.8643% | Test Loss: 0.1840 | Test Acc. 93.6429%
AdamP on CRC_transformed: T 1/3 | E 35/200 Ended | E Time: 58.865s | ~Time Left: 9712.698s |  Train Loss: 0.1272 | Train Acc. 95.6000% | Test Loss: 0.1123 | Test Acc. 96.2143%
AdamP on CRC_transformed: T 1/3 | E 36/200 Ended | E Time: 59.020s | ~Time Left: 9679.273s |  Train Loss: 0.1251 | Train Acc. 95.6643% | Test Loss: 0.1353 | Test Acc. 95.5000%
AdamP on CRC_transformed: T 1/3 | E 37/200 Ended | E Time: 58.938s | ~Time Left: 9606.908s |  Train Loss: 0.1197 | Train Acc. 95.8143% | Test Loss: 0.1577 | Test Acc. 94.6429%
AdamP on CRC_transformed: T 1/3 | E 38/200 Ended | E Time: 59.201s | ~Time Left: 9590.541s |  Train Loss: 0.1184 | Train Acc. 95.7786% | Test Loss: 0.1205 | Test Acc. 95.5714%
AdamP on CRC_transformed: T 1/3 | E 39/200 Ended | E Time: 59.121s | ~Time Left: 9518.414s |  Train Loss: 0.1134 | Train Acc. 95.9571% | Test Loss: 0.1018 | Test Acc. 96.7143%
AdamP on CRC_transformed: T 1/3 | E 40/200 Ended | E Time: 59.082s | ~Time Left: 9453.195s |  Train Loss: 0.1079 | Train Acc. 96.3357% | Test Loss: 0.1117 | Test Acc. 96.1429%
AdamP on CRC_transformed: T 1/3 | E 41/200 Ended | E Time: 59.174s | ~Time Left: 9408.596s |  Train Loss: 0.1086 | Train Acc. 96.3214% | Test Loss: 0.1285 | Test Acc. 95.7857%
AdamP on CRC_transformed: T 1/3 | E 42/200 Ended | E Time: 59.068s | ~Time Left: 9332.786s |  Train Loss: 0.1099 | Train Acc. 96.1429% | Test Loss: 0.1085 | Test Acc. 96.6429%
AdamP on CRC_transformed: T 1/3 | E 43/200 Ended | E Time: 58.983s | ~Time Left: 9260.404s |  Train Loss: 0.1153 | Train Acc. 95.9143% | Test Loss: 0.0963 | Test Acc. 97.0000%
AdamP on CRC_transformed: T 1/3 | E 44/200 Ended | E Time: 58.914s | ~Time Left: 9190.522s |  Train Loss: 0.1111 | Train Acc. 96.3071% | Test Loss: 0.1070 | Test Acc. 96.5000%
AdamP on CRC_transformed: T 1/3 | E 45/200 Ended | E Time: 59.274s | ~Time Left: 9187.510s |  Train Loss: 0.1023 | Train Acc. 96.3571% | Test Loss: 0.1018 | Test Acc. 96.3571%
AdamP on CRC_transformed: T 1/3 | E 46/200 Ended | E Time: 58.894s | ~Time Left: 9069.734s |  Train Loss: 0.1013 | Train Acc. 96.3643% | Test Loss: 0.1749 | Test Acc. 93.1429%
AdamP on CRC_transformed: T 1/3 | E 47/200 Ended | E Time: 59.197s | ~Time Left: 9057.160s |  Train Loss: 0.1014 | Train Acc. 96.3357% | Test Loss: 0.0971 | Test Acc. 96.5714%
AdamP on CRC_transformed: T 1/3 | E 48/200 Ended | E Time: 59.180s | ~Time Left: 8995.384s |  Train Loss: 0.0973 | Train Acc. 96.7429% | Test Loss: 0.1053 | Test Acc. 96.6429%
AdamP on CRC_transformed: T 1/3 | E 49/200 Ended | E Time: 59.999s | ~Time Left: 9059.775s |  Train Loss: 0.0970 | Train Acc. 96.7714% | Test Loss: 0.0820 | Test Acc. 97.3571%
AdamP on CRC_transformed: T 1/3 | E 50/200 Ended | E Time: 59.012s | ~Time Left: 8851.763s |  Train Loss: 0.0964 | Train Acc. 96.6714% | Test Loss: 0.0829 | Test Acc. 96.9286%
AdamP on CRC_transformed: T 1/3 | E 51/200 Ended | E Time: 59.192s | ~Time Left: 8819.658s |  Train Loss: 0.0968 | Train Acc. 96.6143% | Test Loss: 0.0836 | Test Acc. 97.0714%
AdamP on CRC_transformed: T 1/3 | E 52/200 Ended | E Time: 59.167s | ~Time Left: 8756.782s |  Train Loss: 0.0966 | Train Acc. 96.5143% | Test Loss: 0.1005 | Test Acc. 96.3571%
AdamP on CRC_transformed: T 1/3 | E 53/200 Ended | E Time: 59.269s | ~Time Left: 8712.566s |  Train Loss: 0.0918 | Train Acc. 96.9000% | Test Loss: 0.0938 | Test Acc. 96.9286%
AdamP on CRC_transformed: T 1/3 | E 54/200 Ended | E Time: 59.085s | ~Time Left: 8626.386s |  Train Loss: 0.0915 | Train Acc. 96.8000% | Test Loss: 0.0920 | Test Acc. 96.5000%
AdamP on CRC_transformed: T 1/3 | E 55/200 Ended | E Time: 59.167s | ~Time Left: 8579.273s |  Train Loss: 0.0883 | Train Acc. 96.9143% | Test Loss: 0.0814 | Test Acc. 97.2143%
AdamP on CRC_transformed: T 1/3 | E 56/200 Ended | E Time: 59.370s | ~Time Left: 8549.343s |  Train Loss: 0.0845 | Train Acc. 97.0429% | Test Loss: 0.1122 | Test Acc. 96.3571%
AdamP on CRC_transformed: T 1/3 | E 57/200 Ended | E Time: 59.154s | ~Time Left: 8459.090s |  Train Loss: 0.0878 | Train Acc. 96.9857% | Test Loss: 0.0605 | Test Acc. 97.7143%
Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 491, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 10605504 vs 10605392

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/adas/train.py", line 871, in <module>
    main(args)
  File "src/adas/train.py", line 834, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "src/adas/train.py", line 863, in main_worker
    training_agent.train()
  File "src/adas/train.py", line 411, in train
    self.run_epochs(trial, epochs)
  File "src/adas/train.py", line 466, in run_epochs
    torch.save(
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 10605504 vs 10605392
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x2ba9821490e7 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x206a420 (0x2ba9322dd420 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x20665f3 (0x2ba9322d95f3 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x2ba9322ddd99 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x2ba9322de8d1 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x2ba9322df0c5 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x737903 (0x2ba92f1aa903 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x369b90 (0x2ba92eddcb90 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x36adfe (0x2ba92eddddfe in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #22: __libc_start_main + 0xeb (0x2ba92c6c2e1b in /cvmfs/soft.computecanada.ca/gentoo/2020/lib64/libc.so.6)

/var/spool/slurmd/job6958617/slurm_script: line 30: 96008 Aborted                 (core dumped) python src/adas/train.py --config PostTrainingConfigs/CRC_transformed_testing/AdamP/lr-0.00005-config-AdamP.yaml --output ADP_post_trained/CRC_transformed/AdamP/output/fine_tuning --checkpoint ADP_post_trained/CRC_transformed/AdamP/checkpoint/fine_tuning/lr-0.00005 --data $SLURM_TMPDIR --pretrained_model /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar --freeze_encoder True
Adas: Argument Parser Options
---------------------------------------------
    config              : PostTrainingConfigs/CRC_transformed_testing/AdamP/lr-0.00005-config-AdamP.yaml
    data                : /localscratch/zhan8425.6958617.0        
    output              : ADP_post_trained/CRC_transformed/AdamP/output/deep_tuning
    checkpoint          : ADP_post_trained/CRC_transformed/AdamP/checkpoint/deep_tuning/lr-0.00005
    resume              : None                                    
    pretrained_model    : /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar
    freeze_encoder      : 0                                       
    root                : .                                       
    save_freq           : 25                                      
    cpu                 : 0                                       
    gpu                 : 0                                       
    mpd                 : 0                                       
    dist_url            : tcp://127.0.0.1:23456                   
    dist_backend        : nccl                                    
    world_size          : -1                                      
    rank                : -1                                      
---------------------------------------------
Adas: Notice: early stop will not be used as it was set to -1.0, training till completion
Adas: Experiment Configuration
---------------------------------------------
    dataset              CRC_transformed     
    network              ResNet18            
    optimizer            AdamP               
    scheduler            None                
    level                L3Only              
    color_kwargs         {'augmentation': 'Color-Distortion', 'distortion': 0.3}
    degree_of_rotation   45                  
    vertical_flipping    0.5                 
    horizontal_flipping  0.5                 
    horizontal_shift     0.1                 
    vertical_shift       0.1                 
    gaussian_blur        0                   
    kernel_size          9                   
    variance             0.1                 
    cutout               0                   
    n_holes              1                   
    cutout_length        16                  
    init_lr              5e-05               
    early_stop_threshold -1.0                
    optimizer_kwargs     {'weight_decay': 0.0005}
    scheduler_kwargs     {'gamma': 0.5, 'step_size': 20.0}
    p                    1                   
    start_trial          0                   
    n_trials             3                   
    num_workers          4                   
    max_epochs           200                 
    mini_batch_size      32                  
    loss                 cross_entropy       
    early_stop_patience  10                  
---------------------------------------------
Adas: Pytorch device is set to cuda
AdamP on CRC_transformed: T 1/3 | E 1/200 Ended | E Time: 59.624s | ~Time Left: 11865.140s |  Train Loss: 0.8929 | Train Acc. 65.3500% | Test Loss: 0.7144 | Test Acc. 73.5714%
Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 491, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 7863232 vs 7863120

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/adas/train.py", line 871, in <module>
    main(args)
  File "src/adas/train.py", line 834, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "src/adas/train.py", line 863, in main_worker
    training_agent.train()
  File "src/adas/train.py", line 411, in train
    self.run_epochs(trial, epochs)
  File "src/adas/train.py", line 462, in run_epochs
    torch.save(data, str(self.checkpoint_path / filename))
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 7863232 vs 7863120
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x2b76eee3f0e7 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x206a420 (0x2b769efd3420 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x20665f3 (0x2b769efcf5f3 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x2b769efd3d99 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x2b769efd48d1 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x2b769efd50c5 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x737903 (0x2b769bea0903 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x369b90 (0x2b769bad2b90 in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x36adfe (0x2b769bad3dfe in /project/6060173/zhan8425/HistoKT/ENV/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #22: __libc_start_main + 0xeb (0x2b76993b8e1b in /cvmfs/soft.computecanada.ca/gentoo/2020/lib64/libc.so.6)

/var/spool/slurmd/job6958617/slurm_script: line 31: 103359 Aborted                 (core dumped) python src/adas/train.py --config PostTrainingConfigs/CRC_transformed_testing/AdamP/lr-0.00005-config-AdamP.yaml --output ADP_post_trained/CRC_transformed/AdamP/output/deep_tuning --checkpoint ADP_post_trained/CRC_transformed/AdamP/checkpoint/deep_tuning/lr-0.00005 --data $SLURM_TMPDIR --pretrained_model /home/zhan8425/projects/def-plato/zhan8425/HistoKT/.Adas-checkpoint/ADP/best_trial_2.pth.tar --freeze_encoder False
